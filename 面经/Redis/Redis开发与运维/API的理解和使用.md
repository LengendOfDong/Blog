# API的理解和使用

## 为什么单线程还能这么快？

单线程这么快的原因可以归结为三点：

1.纯内存访问，Redis将所有数据都放在内存中，这是Redis能够达到每秒万级访问的重要基础

2.非阻塞I/O，Redis采用epoll作为I/O多路复用技术的实现，再加上Redis自身的事件处理模型将epoll的连接、读写、关闭都转换为事件，不在网络I/O上浪费过多的时间。

3.单线程避免了线程切换和竞态产生的消耗。



字符串类型的典型使用场景：

1.缓存功能

2.计数

3.共享session

4.限速



哈希类型的典型使用场景：

1.相比于字符串序列化缓存用户信息，哈希类型更加直观



列表类型的典型使用场景：

1.消息队列：Redis的lpush + brpop命令组合即可实现阻塞队列，生产者客户端使用lpush从列表的左端插入元素，多个消费者客户端使用brpop命令阻塞式的从列表的右端取元素。

2.文章列表：每个用户都有属于自己的文章列表，同时支持按照索引范围进行获取

使用场景可以参考口诀：

- lpush + lpop = Stack 

- lpush + rpop = Queue

- lpush + ltrim = Capped Collection

- lpush + brpop = Message Queue



集合的典型使用场景：

集合类型比较典型的实用场景是标签。

比如用户1是对娱乐、体育等感兴趣，用户2对音乐、历史感兴趣，每个用户都对应不同的标签。

网站对不同的用户进行划分，使用标签进行推荐。

使用场景口诀：

- sadd = Tagging (标签)

- spop / srandmember = Random item (生成随机数， 比如抽奖)

- sadd + sinter = Social Graph (社交需求)



有序集合的典型使用场景：

有序集合的典型使用场景就是排行榜系统。




